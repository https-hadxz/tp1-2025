<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Formulário de Cadastro</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      padding: 40px;
      width: 100%;
      max-width: 600px;
    }

    h1 {
      color: #333;
      margin-bottom: 10px;
      font-size: 28px;
      font-weight: 700;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    label {
      font-size: 14px;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
    }

    input, select {
      padding: 12px 16px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s ease;
      outline: none;
    }

    input:focus, select:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    input.valid {
      border-color: #10b981;
      background-color: #f0fdf4;
    }

    input.invalid {
      border-color: #ef4444;
      background-color: #fef2f2;
    }

    .error-message {
      color: #ef4444;
      font-size: 12px;
      margin-top: 4px;
      min-height: 18px;
    }

    .success-message {
      color: #10b981;
      font-size: 12px;
      margin-top: 4px;
      min-height: 18px;
    }

    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px 32px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      margin-top: 20px;
      width: 100%;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    button:active {
      transform: translateY(0);
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    @media (max-width: 640px) {
      .form-grid {
        grid-template-columns: 1fr;
      }

      .container {
        padding: 24px;
      }

      h1 {
        font-size: 24px;
      }
    }

    .success-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: white;
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      text-align: center;
      transition: transform 0.3s ease;
      z-index: 1000;
    }

    .success-popup.show {
      transform: translate(-50%, -50%) scale(1);
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 999;
    }

    .overlay.show {
      display: block;
    }

    .checkmark {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: #10b981;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      font-size: 40px;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Formulário de Cadastro</h1>
    <p class="subtitle">Preencha todos os campos para completar seu cadastro</p>

    <form id="cadastroForm">
      <div class="form-grid">
        <div class="form-group full-width">
          <label for="nome">Nome Completo *</label>
          <input type="text" id="nome" name="nome" required>
          <span class="error-message" id="nomeError"></span>
        </div>

        <div class="form-group">
          <label for="cpf">CPF *</label>
          <input type="text" id="cpf" name="cpf" placeholder="000.000.000-00" maxlength="14" required>
          <span class="error-message" id="cpfError"></span>
        </div>

        <div class="form-group">
          <label for="idade">Idade *</label>
          <input type="number" id="idade" name="idade" min="1" max="120" required>
          <span class="error-message" id="idadeError"></span>
        </div>

        <div class="form-group">
          <label for="email">E-mail *</label>
          <input type="email" id="email" name="email" placeholder="exemplo@email.com" required>
          <span class="error-message" id="emailError"></span>
        </div>

        <div class="form-group">
          <label for="telefone">Telefone *</label>
          <input type="text" id="telefone" name="telefone" placeholder="(00) 00000-0000" maxlength="15" required>
          <span class="error-message" id="telefoneError"></span>
        </div>

        <div class="form-group">
          <label for="cep">CEP *</label>
          <input type="text" id="cep" name="cep" placeholder="00000-000" maxlength="9" required>
          <span class="error-message" id="cepError"></span>
        </div>

        <div class="form-group">
          <label for="uf">UF *</label>
          <select id="uf" name="uf" required>
            <option value="">Selecione</option>
            <option value="AC">AC</option>
            <option value="AL">AL</option>
            <option value="AP">AP</option>
            <option value="AM">AM</option>
            <option value="BA">BA</option>
            <option value="CE">CE</option>
            <option value="DF">DF</option>
            <option value="ES">ES</option>
            <option value="GO">GO</option>
            <option value="MA">MA</option>
            <option value="MT">MT</option>
            <option value="MS">MS</option>
            <option value="MG">MG</option>
            <option value="PA">PA</option>
            <option value="PB">PB</option>
            <option value="PR">PR</option>
            <option value="PE">PE</option>
            <option value="PI">PI</option>
            <option value="RJ">RJ</option>
            <option value="RN">RN</option>
            <option value="RS">RS</option>
            <option value="RO">RO</option>
            <option value="RR">RR</option>
            <option value="SC">SC</option>
            <option value="SP">SP</option>
            <option value="SE">SE</option>
            <option value="TO">TO</option>
          </select>
          <span class="error-message" id="ufError"></span>
        </div>

        <div class="form-group full-width">
          <label for="endereco">Endereço</label>
          <input type="text" id="endereco" name="endereco" placeholder="Rua, número, bairro">
        </div>
      </div>

      <button type="submit">Cadastrar</button>
    </form>
  </div>

  <div class="overlay" id="overlay"></div>
  <div class="success-popup" id="successPopup">
    <div class="checkmark">✓</div>
    <h2>Cadastro realizado com sucesso!</h2>
    <p style="margin-top: 10px; color: #666;">Seus dados foram salvos corretamente.</p>
    <button onclick="closePopup()" style="margin-top: 20px;">Fechar</button>
  </div>

  <script>
    // Validação de CPF
    function validaCPF(cpf) {
      cpf = cpf.replace(/[^\d]/g, '');
      
      if (cpf.length !== 11) return false;
      
      const cpfsInvalidos = [
        '00000000000', '11111111111', '22222222222', '33333333333',
        '44444444444', '55555555555', '66666666666', '77777777777',
        '88888888888', '99999999999'
      ];
      
      if (cpfsInvalidos.includes(cpf)) return false;
      
      let soma = 0;
      for (let i = 0; i < 9; i++) {
        soma += parseInt(cpf.charAt(i)) * (10 - i);
      }
      let primeiroDigito = 11 - (soma % 11);
      if (primeiroDigito >= 10) primeiroDigito = 0;
      
      if (primeiroDigito !== parseInt(cpf.charAt(9))) return false;
      
      soma = 0;
      for (let i = 0; i < 10; i++) {
        soma += parseInt(cpf.charAt(i)) * (11 - i);
      }
      let segundoDigito = 11 - (soma % 11);
      if (segundoDigito >= 10) segundoDigito = 0;
      
      return segundoDigito === parseInt(cpf.charAt(10));
    }

    // Formatação de CPF
    const cpfInput = document.getElementById('cpf');
    cpfInput.addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length <= 11) {
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d)/, '$1.$2');
        value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        e.target.value = value;
      }
    });

    cpfInput.addEventListener('blur', function(e) {
      const errorSpan = document.getElementById('cpfError');
      if (e.target.value) {
        if (validaCPF(e.target.value)) {
          e.target.classList.remove('invalid');
          e.target.classList.add('valid');
          errorSpan.textContent = '';
          errorSpan.className = 'success-message';
          errorSpan.textContent = '✓ CPF válido';
        } else {
          e.target.classList.remove('valid');
          e.target.classList.add('invalid');
          errorSpan.className = 'error-message';
          errorSpan.textContent = 'CPF inválido';
        }
      }
    });

    // Formatação de Telefone
    const telefoneInput = document.getElementById('telefone');
    telefoneInput.addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length <= 11) {
        value = value.replace(/(\d{2})(\d)/, '($1) $2');
        value = value.replace(/(\d{5})(\d)/, '$1-$2');
        e.target.value = value;
      }
    });

    // Formatação de CEP
    const cepInput = document.getElementById('cep');
    cepInput.addEventListener('input', function(e) {
      let value = e.target.value.replace(/\D/g, '');
      if (value.length <= 8) {
        value = value.replace(/(\d{5})(\d)/, '$1-$2');
        e.target.value = value;
      }
    });

    // Validação de Nome
    const nomeInput = document.getElementById('nome');
    nomeInput.addEventListener('blur', function(e) {
      const errorSpan = document.getElementById('nomeError');
      const nomeCompleto = e.target.value.trim().split(' ');
      
      if (nomeCompleto.length < 2 || nomeCompleto[1] === '') {
        e.target.classList.add('invalid');
        errorSpan.textContent = 'Digite o nome completo';
      } else {
        e.target.classList.remove('invalid');
        e.target.classList.add('valid');
        errorSpan.textContent = '';
      }
    });

    // Validação de Idade
    const idadeInput = document.getElementById('idade');
    idadeInput.addEventListener('blur', function(e) {
      const errorSpan = document.getElementById('idadeError');
      const idade = parseInt(e.target.value);
      
      if (idade < 1 || idade > 120) {
        e.target.classList.add('invalid');
        errorSpan.textContent = 'Idade inválida';
      } else if (idade < 18) {
        e.target.classList.remove('invalid');
        e.target.classList.add('valid');
        errorSpan.className = 'error-message';
        errorSpan.style.color = '#f59e0b';
        errorSpan.textContent = '⚠ Menor de idade';
      } else {
        e.target.classList.remove('invalid');
        e.target.classList.add('valid');
        errorSpan.textContent = '';
      }
    });

    // Validação de E-mail
    const emailInput = document.getElementById('email');
    emailInput.addEventListener('blur', function(e) {
      const errorSpan = document.getElementById('emailError');
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      
      if (!emailRegex.test(e.target.value)) {
        e.target.classList.add('invalid');
        errorSpan.textContent = 'E-mail inválido';
      } else {
        e.target.classList.remove('invalid');
        e.target.classList.add('valid');
        errorSpan.textContent = '';
      }
    });

    // Validação de CEP e busca de endereço
    cepInput.addEventListener('blur', async function(e) {
      const errorSpan = document.getElementById('cepError');
      const cep = e.target.value.replace(/\D/g, '');
      
      if (cep.length !== 8) {
        e.target.classList.add('invalid');
        errorSpan.textContent = 'CEP inválido';
        return;
      }

      try {
        const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
        const data = await response.json();
        
        if (data.erro) {
          e.target.classList.add('invalid');
          errorSpan.textContent = 'CEP não encontrado';
        } else {
          e.target.classList.remove('invalid');
          e.target.classList.add('valid');
          errorSpan.textContent = '';
          
          // Preenche automaticamente UF e Endereço
          document.getElementById('uf').value = data.uf;
          document.getElementById('endereco').value = `${data.logradouro}, ${data.bairro}, ${data.localidade}`;
        }
      } catch (error) {
        console.error('Erro ao buscar CEP:', error);
      }
    });

    // Validação de Telefone
    telefoneInput.addEventListener('blur', function(e) {
      const errorSpan = document.getElementById('telefoneError');
      const telefone = e.target.value.replace(/\D/g, '');
      
      if (telefone.length < 10) {
        e.target.classList.add('invalid');
        errorSpan.textContent = 'Telefone inválido';
      } else {
        e.target.classList.remove('invalid');
        e.target.classList.add('valid');
        errorSpan.textContent = '';
      }
    });

    // Submissão do formulário
    const form = document.getElementById('cadastroForm');
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // Valida todos os campos novamente
      const campos = ['nome', 'cpf', 'idade', 'email', 'telefone', 'cep', 'uf'];
      let valido = true;
      
      campos.forEach(campo => {
        const input = document.getElementById(campo);
        if (!input.value || input.classList.contains('invalid')) {
          valido = false;
          input.classList.add('invalid');
        }
      });
      
      if (!validaCPF(cpfInput.value)) {
        valido = false;
        cpfInput.classList.add('invalid');
        document.getElementById('cpfError').textContent = 'CPF inválido';
      }
      
      if (valido) {
        // Coleta os dados do formulário
        const formData = {
          nome: document.getElementById('nome').value,
          cpf: document.getElementById('cpf').value,
          idade: document.getElementById('idade').value,
          email: document.getElementById('email').value,
          telefone: document.getElementById('telefone').value,
          cep: document.getElementById('cep').value,
          uf: document.getElementById('uf').value,
          endereco: document.getElementById('endereco').value
        };
        
        console.log('Dados do cadastro:', formData);
        
        // Mostra popup de sucesso
        document.getElementById('overlay').classList.add('show');
        document.getElementById('successPopup').classList.add('show');
        
        // Limpa o formulário
        form.reset();
        document.querySelectorAll('.valid').forEach(el => {
          el.classList.remove('valid');
        });
      }
    });

    function closePopup() {
      document.getElementById('overlay').classList.remove('show');
      document.getElementById('successPopup').classList.remove('show');
    }
  </script>
</body>
</html>
